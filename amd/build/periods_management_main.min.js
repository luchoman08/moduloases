'use strict';define(['jquery','block_ases/bootstrap','block_ases/jquery.dataTables','block_ases/sweetalert','block_ases/select2','block_ases/jqueryui'],function(a){return{init:function init(){function g(l,m){var n=l;n||(n=a('#periods').val()),a.ajax({type:'POST',data:{dat:n},url:'../managers/periods_management/search_period_processing.php',success:function success(o){m?m(o):o.error?(swal('Error',o.error,'error'),a('.assignment_li').addClass('hidden'),a('#periods').val('').trigger('change.select2'),a('#periods').prop('disabled',!1),a('#semester_name').val(''),a('#search_button').prop('disabled',!1)):''==o.nombre?(swal('Error','El semestre no existe en la base de datos','error'),a('#periods').prop('disabled',!1)):(a('.assignment_li').removeClass('hidden'),a('#semester_name').val(o.nombre),a('#beginning_date').val(o.fecha_inicio),a('#ending_date').val(o.fecha_fin))},dataType:'json',error:function error(){swal('Error','Hay un error con la conexi\xF3n','error'),a('.assignment_li').addClass('hidden'),a('#periods').val('').trigger('change.select2'),a('#periods').prop('disabled',!1),a('#semester_name').val(' '),a('#search_button').prop('disabled',!1)}})}function h(){var l=a('#periods').val(),m=a('#semester_name').val(),n=a('#beginning_date').val(),o=a('#ending_date').val(),p=k(m,n,o,l);'success'==p?a.ajax({type:'POST',data:{id:l,name:m,beginning:n,ending:o},url:'../managers/periods_management/update_period_processing.php',success:function success(q){swal({title:'Informaci\xF3n',text:q,type:'info',html:!0,confirmButtonColor:'#d51b23',confirmButtonText:'OK',closeOnConfirm:!0})},dataType:'text',cache:'false',error:function error(){swal('Error','Ha ocurrido un error','error')}}):swal({title:'Advertencia',text:p,type:'warning',html:!0})}function i(){a.ajax({type:'POST',data:{load:'loadSemester'},url:'../managers/periods_management/load_periods_processing.php',success:function success(l){a('#div_periods').empty(),a('#div_periods').append('<table id="tablePeriods" class="display" cellspacing="0" width="100%"><thead><thead></table>');a('#tablePeriods').DataTable(l);a('#div_periods').css('cursor','pointer')},dataType:'json',cache:!1,error:function error(){alert('Error al cargar per\xEDodos')}})}function j(){var l=a('#new_semester_name').val(),m=a('#new_beginning_date').val(),n=a('#new_ending_date').val(),o=k(l,m,n);'success'==o?a.ajax({type:'POST',data:{op:'createSemester',name:l,beginning:m,ending:n},url:'../managers/periods_management/create_period_processing.php',success:function success(p){swal({title:'Informaci\xF3n',text:p,type:'info',html:!0,confirmButtonColor:'#d51b23',confirmButtonText:'OK',closeOnConfirm:!0})},dataType:'text',cache:'false',error:function error(){swal('Error','Ha ocurrido un error','error')}}):swal({title:'Advertencia',text:o,type:'warning',html:!0})}function k(l,m,n,o){var p=/^\d{4}\-(0?[1-9]|1[012])\-(0?[1-9]|[12][0-9]|3[01])$/,q=p.exec(m),r=p.exec(n);if(''==l||''==m||''==n)return'Debe llenar todos los campos';if(null===q)return'La fecha de inicio no sigue el patr\xF3n yyyy-mm-dd. Ejemplo: 2017-10-20';if(null===r)return'La fecha de fin no sigue el patr\xF3n yyyy-mm-dd. Ejemplo: 2017-10-20';if(void 0===!o)return''==o?'Se encontr\xF3 un problema con el identificador del semestre, vuelva a seleccionar el semestre':'success';var s=new Date(m),t=new Date(n);return s>=t?'La fecha de inicio de semestre debe ser menor a la de finalizaci\xF3n':'success'}a('#periods').select2({language:{noResults:function noResults(){return'No se encontraron resultados'},searching:function searching(){return'Buscando...'}},dropDownAutoWidth:!0}),a(document).ready(function(){a('.assignment_li').css({display:'none'}),a('.period_date').datepicker({dateFormat:'yy-mm-dd'}),a('#search_button').on('click',function(){a('#search_button').prop('disabled',!0),g(),a('#periods').prop('disabled',!0),a('.assignment_li').slideToggle('fast')}),a('#ok-button').on('click',function(){h(),a('.assignment_li').addClass('hidden'),a('#periods').val('').trigger('change.select2'),a('#periods').prop('disabled',!1),a('#search_button').prop('disabled',!1),a('#semester_name').val(' '),a('#beginning_date').val(' '),a('#ending_date').val(' ')}),a('#cancel-button').on('click',function(){a('.assignment_li').addClass('hidden'),a('#periods').val('').trigger('change.select2'),a('#periods').prop('disabled',!1),a('#search_button').prop('disabled',!1),a('#semester_name').val(' '),a('#beginning_date').val(' '),a('#ending_date').val(' ')}),a('#save-button').on('click',function(){j(),a('#new_semester_name').val(' '),a('#new_beginning_date').val(' '),a('#new_ending_date').val(' ')}),a('#cancel-save-button').on('click',function(){a('#new_semester_name').val(' '),a('#new_beginning_date').val(' '),a('#new_ending_date').val(' ')}),a('#list-periods-panel').on('click',function(){i()})})}}});